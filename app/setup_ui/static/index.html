<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Model-Proxy Configuration</title>
    <link rel="stylesheet" href="/setup/static/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Auth Screen -->
    <div id="auth-screen" class="auth-screen">
        <div class="auth-card">
            <div class="auth-logo">
                <i class="fas fa-server"></i>
                <h1>Model-Proxy</h1>
            </div>
            <p class="auth-subtitle">Configuration Interface</p>
            
            <div class="auth-form">
                <div class="input-group">
                    <label for="api-key-input">
                        <i class="fas fa-key"></i>
                        Client API Key
                    </label>
                    <input 
                        type="password" 
                        id="api-key-input" 
                        placeholder="Enter your CLIENT_API_KEY"
                        autocomplete="off"
                    >
                </div>
                <button id="auth-btn" class="btn btn-primary btn-full">
                    <i class="fas fa-sign-in-alt"></i>
                    Access Configuration
                </button>
            </div>
            
            <div id="auth-error" class="alert alert-error hidden">
                <i class="fas fa-exclamation-circle"></i>
                <span></span>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app" class="app hidden">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-server"></i>
                    <span>Model-Proxy</span>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Overview</div>
                    <button class="nav-item active" data-page="dashboard">
                        <i class="fas fa-chart-pie"></i>
                        <span>Dashboard</span>
                    </button>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Configuration</div>
                    <button class="nav-item" data-page="providers">
                        <i class="fas fa-cloud"></i>
                        <span>Providers</span>
                        <span class="badge" id="nav-provider-count">0</span>
                    </button>
                    <button class="nav-item" data-page="models">
                        <i class="fas fa-cubes"></i>
                        <span>Models</span>
                        <span class="badge" id="nav-model-count">0</span>
                    </button>
                    <button class="nav-item" data-page="apikeys">
                        <i class="fas fa-key"></i>
                        <span>API Keys</span>
                    </button>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Tools</div>
                    <button class="nav-item" data-page="import-export">
                        <i class="fas fa-exchange-alt"></i>
                        <span>Import / Export</span>
                    </button>
                    <button class="nav-item" data-page="validate">
                        <i class="fas fa-check-circle"></i>
                        <span>Validate</span>
                    </button>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <button class="btn btn-text btn-sm" id="logout-btn">
                    <i class="fas fa-sign-out-alt"></i>
                    Logout
                </button>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Top Bar -->
            <header class="top-bar">
                <h1 id="page-title">Dashboard</h1>
                <div class="top-bar-actions">
                    <button class="btn btn-secondary btn-sm" id="theme-toggle-btn" title="Toggle theme">
                        <i class="fas fa-adjust" id="theme-icon"></i>
                        <span id="theme-label">System</span>
                    </button>
                    <button class="btn btn-secondary btn-sm" id="refresh-btn">
                        <i class="fas fa-sync-alt"></i>
                        Refresh
                    </button>
                </div>
            </header>

            <!-- Content Container -->
            <div class="content-container">
                <!-- Dashboard Page -->
                <div id="page-dashboard" class="page active">
                    <div class="dashboard-stats">
                        <div class="stat-card">
                            <div class="stat-icon providers">
                                <i class="fas fa-cloud"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value" id="dash-provider-count">0</div>
                                <div class="stat-label">Providers</div>
                                <div class="stat-sublabel" id="dash-enabled-providers">0 enabled</div>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon models">
                                <i class="fas fa-cubes"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value" id="dash-model-count">0</div>
                                <div class="stat-label">Models</div>
                                <div class="stat-sublabel">configured</div>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon keys">
                                <i class="fas fa-key"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value" id="dash-keys-count">0</div>
                                <div class="stat-label">API Keys</div>
                                <div class="stat-sublabel" id="dash-keys-providers">0 providers</div>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon status">
                                <i class="fas fa-heartbeat"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value" id="dash-status">OK</div>
                                <div class="stat-label">Status</div>
                                <div class="stat-sublabel">Ready to start</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="dashboard-grid">
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                            </div>
                            <div class="quick-actions">
                                <button class="quick-action-btn" onclick="navigateTo('providers')">
                                    <i class="fas fa-plus-circle"></i>
                                    <span>Add Provider</span>
                                </button>
                                <button class="quick-action-btn" onclick="navigateTo('models')">
                                    <i class="fas fa-plus-circle"></i>
                                    <span>Add Model</span>
                                </button>
                                <button class="quick-action-btn" onclick="navigateTo('apikeys')">
                                    <i class="fas fa-key"></i>
                                    <span>Add API Key</span>
                                </button>
                                <button class="quick-action-btn" onclick="navigateTo('import-export')">
                                    <i class="fas fa-download"></i>
                                    <span>Export Config</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3><i class="fas fa-info-circle"></i> Configuration Info</h3>
                            </div>
                            <div class="config-info">
                                <div class="info-row">
                                    <span class="info-label">Config Directory</span>
                                    <span class="info-value" id="dash-config-dir">-</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Version</span>
                                    <span class="info-value">1.0.0</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Last Updated</span>
                                    <span class="info-value" id="dash-last-updated">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Providers Page -->
                <div id="page-providers" class="page">
                    <div class="page-header">
                        <div class="page-header-left">
                            <h2>LLM Providers</h2>
                            <p class="page-description">Enable and configure LLM service providers</p>
                        </div>
                        <button class="btn btn-primary" id="add-provider-btn">
                            <i class="fas fa-plus"></i>
                            Add Custom Provider
                        </button>
                    </div>
                    
                    <div class="section">
                        <div class="section-header">
                            <h3>Pre-configured Providers</h3>
                            <span class="section-count" id="preconfigured-count">0 providers</span>
                        </div>
                        <div id="preconfigured-providers" class="providers-grid">
                            <!-- Dynamically populated -->
                        </div>
                    </div>
                    
                    <div class="section">
                        <div class="section-header">
                            <h3>Custom Providers</h3>
                            <span class="section-count" id="custom-count">0 providers</span>
                        </div>
                        <div id="custom-providers-list" class="providers-list">
                            <!-- Dynamically populated -->
                        </div>
                    </div>
                </div>

                <!-- Models Page -->
                <div id="page-models" class="page">
                    <div class="page-header">
                        <div class="page-header-left">
                            <h2>Model Routing</h2>
                            <p class="page-description">Configure model fallbacks and routing chains</p>
                        </div>
                        <button class="btn btn-primary" id="add-model-btn">
                            <i class="fas fa-plus"></i>
                            Add Model Configuration
                        </button>
                    </div>
                    
                    <div id="models-list" class="models-list">
                        <!-- Dynamically populated -->
                    </div>
                </div>

                <!-- API Keys Page -->
                <div id="page-apikeys" class="page">
                    <div class="page-header">
                        <div class="page-header-left">
                            <h2>API Keys</h2>
                            <p class="page-description">Manage API keys for enabled providers</p>
                        </div>
                    </div>
                    
                    <div id="api-keys-container" class="api-keys-list">
                        <!-- Dynamically populated -->
                    </div>
                </div>

                <!-- Import/Export Page -->
                <div id="page-import-export" class="page">
                    <div class="page-header">
                        <div class="page-header-left">
                            <h2>Import & Export</h2>
                            <p class="page-description">Backup or transfer your configuration</p>
                        </div>
                    </div>
                    
                    <div class="two-column">
                        <div class="card">
                            <div class="card-header">
                                <h3><i class="fas fa-download"></i> Export Configuration</h3>
                            </div>
                            <div class="card-body">
                                <p class="help-text">Export your complete setup as JSON. API keys are not included for security.</p>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="export-include-keys">
                                        <span>Include API keys (not recommended)</span>
                                    </label>
                                </div>
                                <button class="btn btn-primary btn-full" id="export-btn">
                                    <i class="fas fa-download"></i>
                                    Download Configuration
                                </button>
                                <div id="export-preview" class="code-preview hidden"></div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3><i class="fas fa-upload"></i> Import Configuration</h3>
                            </div>
                            <div class="card-body">
                                <p class="help-text">Import a configuration file from another device.</p>
                                <div class="form-group">
                                    <label class="file-input-label">
                                        <input type="file" id="import-file" accept=".json" hidden>
                                        <span class="btn btn-secondary btn-full">
                                            <i class="fas fa-folder-open"></i>
                                            Select JSON File
                                        </span>
                                        <span class="file-name" id="import-file-name">No file selected</span>
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="import-merge">
                                        <span>Merge with existing configuration</span>
                                    </label>
                                </div>
                                <button class="btn btn-primary btn-full" id="import-btn" disabled>
                                    <i class="fas fa-upload"></i>
                                    Import Configuration
                                </button>
                                <div id="import-preview" class="code-preview hidden"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Validate Page -->
                <div id="page-validate" class="page">
                    <div class="page-header">
                        <div class="page-header-left">
                            <h2>Validate Configuration</h2>
                            <p class="page-description">Check your configuration for errors</p>
                        </div>
                        <button class="btn btn-primary" id="run-validation-btn">
                            <i class="fas fa-play"></i>
                            Run Validation
                        </button>
                    </div>
                    
                    <div id="validation-results" class="validation-results">
                        <div class="empty-state">
                            <i class="fas fa-clipboard-check"></i>
                            <p>Click "Run Validation" to check your configuration</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal: Add Provider -->
    <div id="provider-modal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Custom Provider</h3>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="provider-name">Provider Name <span class="required">*</span></label>
                    <input type="text" id="provider-name" placeholder="e.g., myprovider (lowercase, no spaces)">
                    <span class="help-text">Unique identifier for this provider</span>
                </div>
                <div class="form-group">
                    <label for="provider-display-name">Display Name <span class="required">*</span></label>
                    <input type="text" id="provider-display-name" placeholder="e.g., My Provider">
                    <span class="help-text">Human-readable name shown in the UI</span>
                </div>
                <div class="form-group">
                    <label for="provider-base-url">Base URL <span class="required">*</span></label>
                    <input type="text" id="provider-base-url" placeholder="https://api.example.com/v1">
                    <span class="help-text">The base API endpoint URL</span>
                </div>
                <div class="form-group">
                    <label for="provider-format">API Format <span class="required">*</span></label>
                    <select id="provider-format">
                        <option value="openai">OpenAI</option>
                        <option value="anthropic">Anthropic</option>
                        <option value="gemini">Gemini</option>
                        <option value="azure">Azure</option>
                    </select>
                    <span class="help-text">The API format this provider uses</span>
                </div>
                <div id="provider-form-error" class="alert alert-error hidden">
                    <i class="fas fa-exclamation-circle"></i>
                    <span></span>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary modal-cancel">Cancel</button>
                <button class="btn btn-primary" id="save-provider-btn">
                    <i class="fas fa-save"></i>
                    Save Provider
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Add/Edit Model -->
    <div id="model-modal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="model-modal-title">Configure Model Routing</h3>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label for="model-logical-name">Logical Name <span class="required">*</span></label>
                        <input type="text" id="model-logical-name" placeholder="e.g., turbo">
                        <span class="help-text">The name clients will use</span>
                    </div>
                    <div class="form-group">
                        <label for="model-timeout">Timeout (seconds)</label>
                        <input type="number" id="model-timeout" value="180" min="1">
                    </div>
                    <div class="form-group">
                        <label for="model-cooldown">Cooldown (seconds)</label>
                        <input type="number" id="model-cooldown" value="180" min="1">
                    </div>
                </div>
                
                <div class="form-section">
                    <label>Routing Chain <span class="required">*</span></label>
                    <span class="help-text">Providers are tried in order until one succeeds</span>
                    <div id="model-routings-list" class="routing-list">
                        <!-- Routing entries -->
                    </div>
                    <button type="button" class="btn btn-secondary btn-sm" id="add-routing-btn">
                        <i class="fas fa-plus"></i>
                        Add Provider to Chain
                    </button>
                </div>
                
                <div id="model-form-error" class="alert alert-error hidden">
                    <i class="fas fa-exclamation-circle"></i>
                    <span></span>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary modal-cancel">Cancel</button>
                <button class="btn btn-primary" id="save-model-btn">
                    <i class="fas fa-save"></i>
                    Save Model
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <script src="/setup/static/js/app.js"></script>
</body>
</html>
